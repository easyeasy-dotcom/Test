<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyEasy Visit Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        /* Tab Navigation */
        .tab-nav {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 12px;
            z-index: 10;
        }
        .tab-btn {
            background: rgba(0,0,0,0.15);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab-btn:hover { background: rgba(0,0,0,0.3); transform: translateY(-2px); }
        .tab-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
            font-size: 2.5em;
            padding-top: 40px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        /* Welcome & Quote */
        .welcome-message {
            text-align: center;
            color: #333;
            font-size: 1.3em;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            min-height: 80px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        .greeting { font-weight: bold; margin-bottom: 8px; }
        .milestones { margin-top: 12px; }
        .badge {
            display: inline-block;
            background: #ff6b6b;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            margin: 4px;
            font-size: 0.9em;
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        .quote-container {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            color: #333;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .quote { font-style: italic; font-size: 1.4em; margin-bottom: 12px; line-height: 1.6; }
        .quote-author { font-weight: 600; opacity: 0.9; }

        /* Stats Cards */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .stat-number { font-size: 2.5em; font-weight: bold; margin-bottom: 5px; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }

        /* More Data Cards */
        .advanced-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        .advanced-card {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 30px;
            border-radius: 18px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(17,153,142,0.3);
            transition: transform 0.3s;
        }
        .advanced-card:hover { transform: translateY(-5px); }
        .advanced-card:nth-child(2) { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .advanced-card:nth-child(3) { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); }
        .advanced-card:nth-child(4) { background: linear-gradient(135deg, #ff6e7f 0%, #bfe9ff 100%); }
        .advanced-value { font-size: 3em; font-weight: bold; margin-bottom: 10px; }

        /* Shared */
        .chart-container { position: relative; height: 400px; margin-bottom: 40px; }
        .chart-title { text-align: center; font-size: 1.3em; color: #333; margin-bottom: 15px; font-weight: 600; }
        .date-selector, .period-selector, .button-group {
            display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; padding: 12px 30px; border-radius: 25px;
            font-size: 1em; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
        .period-btn.active { background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); }

        .insights-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 15px;
            color: #555;
            line-height: 1.8;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        @media (max-width: 600px) {
            .container { padding: 20px; }
            h1 { font-size: 2em; padding-top: 80px; }
            .tab-nav { position: static; margin-bottom: 20px; justify-content: center; }
            .stat-number, .advanced-value { font-size: 2em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tabs -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="openTab('main')">üìä Dashboard</button>
            <button class="tab-btn" onclick="openTab('more')">üìà More Data</button>
        </div>

        <!-- Main Dashboard -->
        <div id="main" class="tab-content active">
            <h1>üìä EasyEasy Visit Tracker</h1>
            <p class="subtitle">Your personal habit tracker</p>

            <div class="welcome-message" id="welcomeMessage">Loading...</div>

            <div class="quote-container">
                <div class="quote" id="quoteText"></div>
                <div class="quote-author" id="quoteAuthor"></div>
            </div>

            <div class="stats">
                <div class="stat-card"><div class="stat-number" id="totalVisits">0</div><div class="stat-label">Total Visits</div></div>
                <div class="stat-card"><div class="stat-number" id="currentStreak">0</div><div class="stat-label">Current Streak üî•</div></div>
                <div class="stat-card"><div class="stat-number" id="daysLogged">0</div><div class="stat-label" id="daysLoggedLabel">Days Logged</div></div>
                <div class="stat-card"><div class="stat-number" id="currentTime">--:--</div><div class="stat-label">Current Time</div></div>
            </div>

            <div class="period-selector">
                <button class="period-btn active" onclick="changePeriod(30)">Last 30 Days</button>
                <button class="period-btn" onclick="changePeriod(40)">Last 40 Days</button>
                <button class="period-btn" onclick="changePeriod(50)">Last 50 Days</button>
            </div>

            <h3 class="chart-title">üïê Visit Times Throughout the Day</h3>
            <div class="date-selector">
                <label for="dateFilter">Select Date:</label>
                <input type="date" id="dateFilter" onchange="filterByDate()">
                <button onclick="showAllDates()">Show All Dates</button>
            </div>
            <div class="chart-container"><canvas id="visitChart"></canvas></div>

            <h3 class="chart-title">üìÖ Daily Activity Tracker</h3>
            <div class="chart-container"><canvas id="activityChart"></canvas></div>

            <div class="button-group">
                <button onclick="addTestData()">Add Test Data</button>
                <button onclick="clearData()">Clear All Data</button>
                <button onclick="exportData()">Export Data</button>
            </div>
        </div>

        <!-- More Data Tab -->
        <div id="more" class="tab-content">
            <h1>üìà Advanced Insights</h1>
            <p class="subtitle">Deep dive into your patterns</p>

            <div class="advanced-stats" id="advancedStats">
                <!-- Filled by JS -->
            </div>

            <div class="insights-box" id="insightsBox">
                Loading insights...
            </div>
        </div>
    </div>

    <script>
        const quotes = [
            { text: "The secret of change is to focus all your energy not on fighting the old, but on building the new.", author: "Socrates" },
            { text: "You don‚Äôt have to be extreme, just consistent.", author: "Unknown" },
            { text: "Small steps every day lead to big changes over time.", author: "Unknown" },
            { text: "Progress, not perfection.", author: "Unknown" },
            { text: "One day or day one. You decide.", author: "Unknown" },
            { text: "The journey of a thousand miles begins with a single step.", author: "Lao Tzu" },
            { text: "Fall seven times, stand up eight.", author: "Japanese Proverb" },
            { text: "You are stronger than your strongest excuse.", author: "Unknown" },
            { text: "Every day is a new chance to improve.", author: "Unknown" },
            { text: "The best time to start was yesterday. The next best time is now.", author: "Unknown" },
            { text: "Little by little, a little becomes a lot.", author: "Unknown" },
            { text: "Keep going. You are getting there.", author: "Unknown" },
            { text: "You‚Äôve survived 100% of your worst days. You‚Äôre doing great.", author: "Unknown" }
            // Add more as needed
        ];

        let visitChart, activityChart;
        let visits = [];
        let currentPeriod = 30;
        let selectedDate = null;

        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            if (tabName === 'more') updateMoreDataTab();
        }

        async function init() {
            await loadVisits();
            await logVisit();
            displayQuote();
            updateWelcomeAndStats();
            setDefaultDate();
            createVisitChart();
            createActivityChart();
            updateClock();
            setInterval(updateClock, 1000);
        }

        async function loadVisits() {
            const stored = localStorage.getItem('visit-times');
            if (stored) visits = JSON.parse(stored);
        }

        async function saveVisits() {
            localStorage.setItem('visit-times', JSON.stringify(visits));
        }

        async function logVisit() {
            const now = new Date();
            const todayStr = now.toLocaleDateString();
            if (!visits.some(v => v.date === todayStr)) {
                visits.push({
                    timestamp: now.toISOString(),
                    date: todayStr,
                    time: now.toLocaleTimeString()
                });
                await saveVisits();
            }
        }

        function getTimeGreeting() {
            const h = new Date().getHours();
            if (h >= 6 && h < 12) return "‚òÄÔ∏è Good morning!";
            if (h >= 12 && h < 18) return "üå§Ô∏è Good afternoon!";
            if (h >= 18) return "üåô Good evening!";
            return "üåü Burning the midnight oil?";
        }

        function calculateStreak() {
            if (visits.length === 0) return 0;
            const dates = [...new Set(visits.map(v => v.date))].sort((a,b) => new Date(b) - new Date(a));
            let streak = 0;
            const today = new Date();
            for (let i = 0; ; i++) {
                const check = new Date(today);
                check.setDate(check.getDate() - i);
                if (dates.includes(check.toLocaleDateString())) streak++;
                else if (i === 0) continue;
                else break;
            }
            return streak;
        }

        function getMilestones() {
            const total = visits.length;
            const streak = calculateStreak();
            const badges = [];
            if (total === 1) badges.push("üéâ First Visit!");
            if (total >= 10) badges.push("‚≠ê 10 Visits");
            if (total >= 50) badges.push("üí™ 50 Visits");
            if (total >= 100) badges.push("üî• 100 Visits");
            if (total >= 500) badges.push("üèÜ 500 Visits");
            if (streak >= 7) badges.push("üî• 7-Day Streak");
            if (streak >= 30) badges.push("üíé 30-Day Streak");
            return badges;
        }

        function updateWelcomeAndStats() {
            const greeting = getTimeGreeting();
            const total = visits.length;
            const streak = calculateStreak();
            const base = total === 1 
                ? `${greeting}<br>üéâ Welcome! This is your first visit!`
                : `${greeting}<br>üëã Welcome back! Visit #${total} ‚Ä¢ Streak: ${streak} days üî•`;

            const badges = getMilestones();
            const badgeHtml = badges.length ? `<div class="milestones">${badges.map(b => `<span class="badge">${b}</span>`).join('')}</div>` : '';

            document.getElementById('welcomeMessage').innerHTML = base + badgeHtml;

            // Main stats
            document.getElementById('totalVisits').textContent = total;
            document.getElementById('currentStreak').textContent = streak;
            const uniqueInPeriod = new Set(visits.filter(v => {
                const vd = new Date(v.timestamp);
                const cutoff = new Date(); cutoff.setDate(cutoff.getDate() - currentPeriod);
                return vd >= cutoff;
            }).map(v => v.date)).size;
            document.getElementById('daysLogged').textContent = `${uniqueInPeriod}/${currentPeriod}`;
        }

        function displayQuote() {
            const q = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('quoteText').textContent = `‚Äú${q.text}‚Äù`;
            document.getElementById('quoteAuthor').textContent = `‚Äî ${q.author}`;
        }

        function updateClock() {
            document.getElementById('currentTime').textContent = new Date().toLocaleTimeString();
        }

        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateFilter').value = today;
            selectedDate = new Date().toLocaleDateString();
        }

        function filterByDate() {
            const val = document.getElementById('dateFilter').value;
            selectedDate = val ? new Date(val).toLocaleDateString() : null;
            createVisitChart();
        }

        function showAllDates() {
            selectedDate = null;
            document.getElementById('dateFilter').value = '';
            createVisitChart();
        }

        function changePeriod(days) {
            currentPeriod = days;
            document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            updateWelcomeAndStats();
            createActivityChart();
        }

        function createVisitChart() {
            const ctx = document.getElementById('visitChart').getContext('2d');
            const filtered = selectedDate ? visits.filter(v => v.date === selectedDate) : visits;
            const byHour = {};
            filtered.forEach(v => {
                const h = new Date(v.timestamp).getHours();
                byHour[h] = (byHour[h] || 0) + 1;
            });
            const labels = Object.keys(byHour).sort((a,b)=>+a-+b).map(h => `${h}:00`);
            const data = labels.map(l => byHour[+l.split(':')[0]]);

            if (visitChart) visitChart.destroy();
            visitChart = new Chart(ctx, {
                type: 'line',
                data: { labels, datasets: [{ label: 'Visits', data, borderColor: '#667eea', backgroundColor: 'rgba(102,126,234,0.1)', fill: true, tension: 0.4 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: labels.length ? (selectedDate || 'All Visit Times') : 'No data yet' } }, scales: { y: { beginAtZero: true } } }
            });
        }

        function createActivityChart() {
            const ctx = document.getElementById('activityChart').getContext('2d');
            const now = new Date();
            const labels = [], data = [];
            for (let i = currentPeriod - 1; i >= 0; i--) {
                const d = new Date(now); d.setDate(d.getDate() - i);
                const str = d.toLocaleDateString();
                labels.push(str);
                data.push(visits.some(v => v.date === str) ? 1 : 0);
            }
            if (activityChart) activityChart.destroy();
            activityChart = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets: [{ data, backgroundColor: data.map(v => v ? '#764ba2' : '#eee') }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { max: 1, ticks: { callback: v => v ? '‚úì' : '‚úó' } } } }
            });
        }

        function updateMoreDataTab() {
            if (visits.length === 0) {
                document.getElementById('advancedStats').innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#999;font-size:1.5em;">No data yet ‚Äì keep visiting!</p>';
                document.getElementById('insightsBox').textContent = 'Start tracking to see insights!';
                return;
            }

            // Most active hour
            const hours = {}; visits.forEach(v => { const h = new Date(v.timestamp).getHours(); hours[h] = (hours[h]||0)+1; });
            const peak = Object.keys(hours).reduce((a,b) => hours[a] > hours[b] ? a : b);
            const peakTime = `${peak}:00 - ${+peak+1}:00`;

            // Avg visits/day
            const uniqueDays = new Set(visits.map(v => v.date)).size;
            const avg = (visits.length / uniqueDays).toFixed(1);

            // Favorite day
            const dayNames = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
            const dayCount = {}; visits.forEach(v => { const d = new Date(v.timestamp).getDay(); dayCount[d] = (dayCount[d]||0)+1; });
            const favDayNum = Object.keys(dayCount).reduce((a,b) => dayCount[a] > dayCount[b] ? a : b);
            const favDay = dayNames[favDayNum];

            // Today's progress
            const today = new Date().toLocaleDateString();
            const todayCount = visits.filter(v => v.date === today).length;
            const progress = Math.min(100, Math.round((todayCount / 3) * 100));

            document.getElementById('advancedStats').innerHTML = `
                <div class="advanced-card"><div class="advanced-value">${peakTime}</div><div class="stat-label">Most Active Time</div></div>
                <div class="advanced-card"><div class="advanced-value">${avg}</div><div class="stat-label">Avg Visits/Day</div></div>
                <div class="advanced-card"><div class="advanced-value">${favDay}</div><div class="stat-label">Favorite Day</div></div>
                <div class="advanced-card"><div class="advanced-value">${todayCount}/3</div><div class="stat-label">Today's Goal</div></div>
            `;

            // Insights
            let timeText = peak < 12 ? "morning person" : peak < 18 ? "afternoon active" : "night owl";
            document.getElementById('insightsBox').innerHTML = `
                üìç You're a <strong>${timeText}</strong> ‚Äì peak around ${peak}:00<br>
                üìÖ <strong>${favDay}</strong> is your most active day<br>
                üî• Current streak: <strong>${calculateStreak()} days</strong><br>
                üìä Average <strong>${avg} visits per day</strong><br>
                ${avg >= 3 ? 'üéâ Excellent consistency!' : 'üí° Aim for 3 visits daily!'}
            `;
        }

        async function addTestData() {
            const now = new Date();
            for (let i = 0; i < 18; i++) {
                const daysAgo = Math.floor(Math.random() * 35);
                const date = new Date(now); date.setDate(date.getDate() - daysAgo);
                const count = Math.floor(Math.random() * 5) + 1;
                for (let j = 0; j < count; j++) {
                    const hour = Math.floor(Math.random() * 18) + 6;
                    const ts = new Date(date); ts.setHours(hour);
                    visits.push({ timestamp: ts.toISOString(), date: date.toLocaleDateString(), time: ts.toLocaleTimeString() });
                }
            }
            await saveVisits();
            location.reload();
        }

        function clearData() {
            if (confirm('Clear all data? Cannot be undone.')) {
                visits = [];
                localStorage.removeItem('visit-times');
                location.reload();
            }
        }

        function exportData() {
            const blob = new Blob([JSON.stringify(visits, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'visits.json'; a.click();
        }

        init();
    </script>
</body>
</html>
